<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Clarity Engine™ by Amber</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');

  :root {
    --bg-top: #FCE9EC;
    --bg-bottom: #FFFDFD;
    --text: #3C3C3C;
    --accent: #FF9AA2;
    --soft-gray: #EAE6E7;
  }

  body {
    font-family: "Inter", sans-serif;
    background: linear-gradient(180deg, var(--bg-top) 0%, var(--bg-bottom) 100%);
    margin: 0;
    height: 100vh;
    color: var(--text);
    display: flex;
    flex-direction: column;
  }

  header {
    text-align: center;
    font-weight: 600;
    padding: 1.5rem 0;
    font-size: 1.2rem;
    letter-spacing: -0.01em;
  }

  #chat {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    max-width: 700px;
    width: 100%;
    margin: 0 auto;
    padding: 2rem 1rem 6rem;
  }

  .message {
    max-width: 80%;
    padding: 1rem 1.25rem;
    margin-bottom: 1rem;
    border-radius: 1rem;
    line-height: 1.8;
    opacity: 0;
    animation: fadeIn 0.4s ease forwards;
  }

  .user {
    align-self: flex-end;
    background: var(--soft-gray);
  }

  .engine {
    align-self: flex-start;
    background: var(--accent);
    color: #fff;
    font-weight: 500;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(8px); }
    to { opacity: 1; transform: translateY(0); }
  }

  #inputArea {
    position: fixed;
    bottom: 0;
    width: 100%;
    background: rgba(255,255,255,0.9);
    border-top: 1px solid var(--soft-gray);
    padding: 1rem 2rem;
    display: flex;
    justify-content: center;
  }

  #userInput {
    width: 100%;
    max-width: 700px;
    font-family: inherit;
    font-size: 1rem;
    padding: 1rem;
    border: 1px solid var(--soft-gray);
    border-radius: 0.75rem;
    outline: none;
  }

  #typing {
    align-self: flex-start;
    display: none;
    font-size: 1.4rem;
    color: var(--accent);
    letter-spacing: 2px;
  }
</style>
</head>
<body>
  <header>Clarity Engine™ by Amber</header>
  <div id="chat"></div>

  <div id="inputArea">
    <input type="text" id="userInput" placeholder="Type your first thought..." autocomplete="off" />
  </div>

  <script>
    const chat = document.getElementById('chat');
    const input = document.getElementById('userInput');

    // internal state
    let step = 'reflect';

    // engine rules
    const voiceRules = {
      declarative: true,
      directNotHarsh: true,
      structured: true,
      calm: true
    };

    input.addEventListener('keydown', e => {
      if (e.key === 'Enter' && input.value.trim() !== '') {
        const text = input.value.trim();
        appendMessage(text, 'user');
        input.value = '';
        engineRespond(text);
      }
    });

    function appendMessage(text, sender) {
      const msg = document.createElement('div');
      msg.classList.add('message', sender);
      msg.innerText = text;
      chat.appendChild(msg);
      chat.scrollTop = chat.scrollHeight;
    }

    async function engineRespond(userText) {
      showTyping(true);
      await pause(1000); // 1-sec pause per dot × 3 below
      for (let i=0;i<3;i++){await pause(1000);}
      showTyping(false);

      const response = generateResponse(userText);
      appendMessage(response, 'engine');
    }

    function showTyping(show){
      let typing = document.getElementById('typing');
      if(!typing){
        typing = document.createElement('div');
        typing.id='typing';
        typing.innerText='...';
        chat.appendChild(typing);
      }
      typing.style.display = show ? 'block' : 'none';
      chat.scrollTop = chat.scrollHeight;
    }

    function pause(ms){ return new Promise(res => setTimeout(res, ms)); }

    function generateResponse(inputText){
      inputText = inputText.toLowerCase();

      // Step logic invisible but structured
      let response = '';
      if(step==='reflect'){
        response = reflectStage(inputText);
        step='organize';
      } else if(step==='organize'){
        response = organizeStage(inputText);
        step='decide';
      } else if(step==='decide'){
        response = decideStage(inputText);
        step='confirm';
      } else {
        response = confirmStage(inputText);
        step='reflect';
      }
      return response;
    }

    function reflectStage(text){
      return `You’re carrying complexity around "${text}".\n\nLet’s separate what actually matters from what’s just noise.`;
    }

    function organizeStage(text){
      return `Here’s the structure underneath this:\n\n• Core issue: mis-sequenced priorities\n• Secondary friction: unclear next action\n\nLet’s narrow it.`;
    }

    function decideStage(text){
      return `Direction:\n\nFocus on one executable move within 30 minutes.\nThat’s the structural fix that restarts momentum.`;
    }

    function confirmStage(text){
      return `You’re clear.\n\nExecute that next move.\nThen stop.\n\nCome back when you need the next layer of clarity.`;
    }
  </script>
</body>
</html>

